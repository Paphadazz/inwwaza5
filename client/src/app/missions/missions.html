<div class="filter-form">
    <div class="search-group">
        <mat-icon class="search-icon">search</mat-icon>
        <input type="text" [(ngModel)]="filter.name" placeholder="Search mission name..." />
    </div>
    
    <div class="filter-group">
        <mat-icon class="filter-icon">filter_list</mat-icon>
        <select [(ngModel)]="filter.status">
            <option value="">All Status</option>
            <option value="Open">Open</option>
            <option value="InProgress">In Progress</option>
            <option value="Completed">Completed</option>
            <option value="Failed">Failed</option>
        </select>
    </div>
    
    <button (click)="onSubmit()" class="go-btn">
        <mat-icon>search</mat-icon>
        Search
    </button>
</div>

<div class="mission-list">
    @if((missions$ | async)?.length) {
    <div class="header">
        <span class="col-name">Name</span>
        <span class="col-desc">Description</span>
        <span class="col-crew">Crew</span>
        <span class="col-status">Status</span>
        <span class="col-created">Created</span>
        <span class="col-updated">Updated</span>
        <span class="col-action">Actions</span>
    </div>
    }

    @for (mission of missions$ | async; track mission.id) {
    <div class="contents">
        <span class="col-name">{{mission.name}}</span>
        <span class="col-desc">{{mission.description}}</span>
        <span class="col-crew">
            <mat-icon style="font-size: 1rem; width: 1rem; height: 1rem; vertical-align: middle; margin-right: 4px;">group</mat-icon>
            {{mission.crew_count}}
        </span>
        <span class="col-status">{{mission.status}}</span>
        <span class="col-created">{{mission.created_at | date:'M/d/yy'}}</span>
        <span class="col-updated">{{mission.updated_at | date:'M/d/yy'}}</span>

        <span class="col-action">
            @if(isSignin()){
            @if(mission.chief_id !== currentUserId()){
            @if(mission.is_joined){
            <a class="leave-link" (click)="onLeave(mission.id)">Leave</a>
            } @else {
            <a class="join-link" (click)="onJoin(mission.id)">Join</a>
            }
            } @else {
            <span class="chief-tag">Your Mission</span>
            }
            }
        </span>
    </div>
    } @empty {
        <div style="padding: 3rem; text-align: center; color: #64748b;">
            <mat-icon style="font-size: 3rem; width: 3rem; height: 3rem; margin-bottom: 1rem; opacity: 0.5;">search_off</mat-icon>
            <p>No missions found matching your criteria.</p>
        </div>
    }
</div>
